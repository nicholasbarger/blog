{"id":"linq-to-sql-basic-operations","title":"Linq to SQL Basic Operations","description":"","link":"http://nicholasbarger.com/2008/10/21/linq-to-sql-basic-operations/","pubDate":"2008-10-21T18:32:01.000Z","content":"The following is a very brief demonstration of Linq to SQL to retrieve, insert, update, and delete a row of data.  I make no claims that this is the most efficient or best practice of Linq, but simply a starting point.There are various resources all over the internet for extended information on Linq; these would be better suited to discuss why to use Linq as well as advanced how-to information as well.<ul><li><a href=\"http://msdn.microsoft.com/en-us/library/bb425822.aspx\" target=\"_blank\">MSDN Linq to SQL Reference</a></li><li><a href=\"http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx\" target=\"_blank\">Scott Guthrie's Blog (Linq to SQL article)</a></li></ul>For demonstration purposes, we'll use a fictious table schema based around a <em>User</em>.<h2>Retrieve Record</h2><div class=\"c_block\"><pre>public static User GetUser(int UserID){    MasterDataContext dc = new MasterDataContext();    var query = from a in dc.Users                where a.UserID == UserID                select a;    return query.Single&lt;User&gt;();}</pre></div><h2>Create Record</h2><div class=\"c_block\"><pre>public static void CreateUser(string EmailAddress, string Password, string Alias, string FirstName, string LastName, string City, string State, string Country, string Zip, string Description){    MasterDataContext dc = new MasterDataContext();    var usr = new User();    usr.Email = EmailAddress;    usr.Password = Password;    usr.Alias = Alias;    usr.FirstName = FirstName;    usr.LastName = LastName;    usr.City = City;    usr.State = State;    usr.Country = Country;    usr.Zip = Zip;    usr.Description = Description;    usr.Created = DateTime.Now;    usr.LastUpdated = DateTime.Now;    dc.Users.InsertOnSubmit(usr);    dc.SubmitChanges();}</pre></div><h2>Update Record</h2><div class=\"c_block\"><pre>public static void UpdateUser(int UserID, string EmailAddress, string Password, string Alias, string FirstName, string LastName, string City, string State, string Country, string Zip, string Description){    MasterDataContext dc = new MasterDataContext();    var query = from a in dc.Users                where a.UserID == UserID                select a;    var usr = query.Single();    usr.Email = EmailAddress;    usr.Password = Password;    usr.Alias = Alias;    usr.FirstName = FirstName;    usr.LastName = LastName;    usr.City = City;    usr.State = State;    usr.Country = Country;    usr.Zip = Zip;    usr.Description = Description;    usr.LastUpdated = DateTime.Now;    dc.SubmitChanges();}</pre></div><h2>Delete Record</h2><div class=\"c_block\"><pre>public static void DeleteUser(int UserID){    MasterDataContext dc = new MasterDataContext();    var query = from a in dc.Users                where a.UserID == UserID                select a;    var usr = query.Single&lt;User&gt;();    dc.Users.DeleteOnSubmit(usr);    dc.SubmitChanges();}</pre></div>"}