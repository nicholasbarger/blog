{"id":"staying-in-touch---how-to-build-a-contact-form","title":"Staying in Touch - How to Build a Contact Form","description":"","link":"http://nicholasbarger.com/2009/07/14/staying-in-touch-how-to-build-a-contact-form/","pubDate":"2009-07-14T23:52:44.000Z","content":"<p>Whether you are a Fortune 500 company or a mom-and-pop shop online, you need some way for visitors to contact you.  Most contact forms are pretty much the same, you choose what information you want your visitors to provide to you as well as an open area for any comments/questions they would like to leave.  The information is then sent to an administrator email account for correspondence.  You may also want to display a confirmation to the user that their email has been sent.</p><p>To demonstrate how to do this, I will use my own contact form in ASP.NET (VB.NET) and an old PHP version I used to run a long time ago.</p><h2>ASP.NET</h2><p>For those of you Microsoft-based developers, here is some sample code that can be used as a base for your contact forms.</p><h4>ASPX (frontend)</h4><div class=\"html_block\"><pre>&lt;h1&gt;Contact Nicholas Barger&lt;/h1&gt;&lt;p&gt;Please feel free to contact me with questions, comments, or anything else that you would like to discuss. I appreciate your interest/involvement so I try and respond as quickly as possible.&lt;/p&gt;&lt;p&gt;You can also find me on &lt;i&gt;LinkedIn&lt;/i&gt; at: &lt;a href=\"http://www.linkedin.com/in/nicholasbarger\" target=\"_blank\"&gt;http://www.linkedin.com/in/nicholasbarger&lt;/a&gt;&lt;/p&gt;&lt;div class=\"formdisplay\"&gt;&lt;span&gt;Please enter your email address:&lt;/span&gt;&lt;br /&gt;&lt;asp:TextBox ID=\"tbEmail\" runat=\"server\" Width=\"700px\"&gt;&lt;/asp:TextBox&gt;&lt;br /&gt;&lt;span&gt;Please enter a subject for this message:&lt;/span&gt;&lt;br /&gt;&lt;asp:TextBox ID=\"tbSubject\" runat=\"server\" Width=\"700px\"&gt;&lt;/asp:TextBox&gt;&lt;br /&gt;&lt;span&gt;Please enter your message below:&lt;/span&gt;&lt;br /&gt;&lt;asp:TextBox ID=\"tbMessage\" runat=\"server\" TextMode=\"MultiLine\" Width=\"700px\" Height=\"250px\"&gt;&lt;/asp:TextBox&gt;&lt;br /&gt;&lt;/div&gt;&lt;asp:Button ID=\"btnSubmit\" runat=\"server\" Text=\"Send Message\" /&gt;</pre></div><h4>VB.NET (backend/codebehind)</h4><div class=\"vb_block\"><pre>Protected Sub btnSubmit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnSubmit.Click'Prep basic valuesDim strFromEmail As String = tbEmail.TextDim strToEmail As String = ConfigurationManager.AppSettings(\"AdminEmail\")Dim strSubject As String = tbSubject.Text'Prep custom valuesDim strBody As String = \"\"Dim strFromName As String = \"\"strBody = tbMessage.TextDim oCommonFunc As New Common.FunctionsTry\toCommonFunc.sendEmail(strFromEmail, strFromName, strToEmail, strSubject, strBody, Nothing, Nothing, Nothing, True)\tResponse.Redirect(\"contactcomplete.aspx\")Catch ex As Exception\t'TODO - Display Error MessageFinally\toCommonFunc = NothingEnd TryEnd Sub</pre></div><h4>VB.NET (common class/codebehind)</h4><div class=\"vb_block\"><pre>Public Function sendEmail(ByVal strFromEmail As String, _ByVal strFromName As String, _ByVal strToEmail As String, _ByVal strSubject As String, _ByVal strBody As String, _Optional ByVal strCCEmail As String = Nothing, _Optional ByVal strBCCEmail As String = Nothing, _Optional ByVal strAttachmentPath As String = Nothing, _Optional ByVal bIsHTML As Boolean = False) As Boolean'Check for proper from emailIf String.IsNullOrEmpty(strFromEmail) = True Then\tThrow New Exception(\"From email is not specified.\")End If'Check for proper to emailIf String.IsNullOrEmpty(strToEmail) = True Then\tThrow New Exception(\"To email is not specified.\")End If'Check for a non-empty message subjectIf String.IsNullOrEmpty(strSubject) = True Then\tThrow New Exception(\"Subject was not specified.\")End If'Check for a non-empty message bodyIf String.IsNullOrEmpty(strBody) = True Then\tThrow New Exception(\"Body of email was not specified.\")End If'Create mail objectDim oMail As New MailMessage()'oMail.Host = ConfigurationManager.AppSettings(\"MailHost\")'Convert all \",\" into \";\"strToEmail = strToEmail.Replace(\",\", \";\")'Check if \"To\" email contains multiple emailsIf strToEmail.IndexOf(\";\") &gt;= 0 Then 'add multiple emails\tDim strToArray As String() = Split(strToEmail, \";\")\tFor i As Integer = 0 To strToArray.Length - 1\t\toMail.To.Add(strToArray(i))\tNextElse 'add single email\toMail.To.Add(strToEmail)End If'If CC existsIf String.IsNullOrEmpty(strCCEmail) = False Then\t'Convert all \",\" into \";\"\tstrCCEmail = strCCEmail.Replace(\",\", \";\")\t'Check if \"CC\" email contains multiple emails\tIf strCCEmail.IndexOf(\";\") &gt;= 0 Then 'add multiple emails\t\tDim strCCArray As String() = Split(strCCEmail, \";\")\t\tFor i As Integer = 0 To strCCArray.Length - 1\t\t\toMail.CC.Add(strCCArray(i))\t\tNext\tElse 'add single email\t\toMail.CC.Add(strCCEmail)\tEnd IfEnd If'If BCC ExistsIf String.IsNullOrEmpty(strBCCEmail) = False Then\t'Convert all \",\" into \";\"\tstrBCCEmail = strBCCEmail.Replace(\",\", \";\")\t'Check if \"BCC\" email contains multiple emails\tIf strBCCEmail.IndexOf(\";\") &gt;= 0 Then 'add multiple emails\t\tDim strBCCArray As String() = Split(strBCCEmail, \";\")\t\tFor i As Integer = 0 To strBCCArray.Length - 1\t\t\toMail.Bcc.Add(strBCCArray(i))\t\tNext\tElse 'add single email\t\toMail.Bcc.Add(strBCCEmail)\tEnd IfEnd If'Add additional information to mail objectoMail.From = New MailAddress(strFromEmail, strFromName)oMail.Subject = strSubjectoMail.Body = strBodyIf bIsHTML = True Then\t'oMail.IsHTML = True\toMail.IsBodyHtml = TrueEnd IfDim strSMTPUserName As String = ConfigurationManager.AppSettings(\"SMTPEmail\")Dim strSMTPPassword As String = ConfigurationManager.AppSettings(\"SMTPPassword\")Dim smtpClient As New SmtpClient(ConfigurationManager.AppSettings(\"MailHost\"))smtpClient.Credentials = New Net.NetworkCredential(strSMTPUserName, strSMTPPassword)oMail.DeliveryNotificationOptions = DeliveryNotificationOptions.OnFailureIf String.IsNullOrEmpty(strFromEmail) = False Then\toMail.ReplyTo = New MailAddress(strFromEmail)End IfIf String.IsNullOrEmpty(strFromEmail) = False Then\toMail.Headers.Add(\"Return-Path\", strFromEmail)\toMail.Headers.Add(\"Errors-To\", strFromEmail)\toMail.Headers.Add(\"Bounces_To\", strFromEmail)End If'Add attachmentIf String.IsNullOrEmpty(strAttachmentPath) = False Then\toMail.Attachments.Add(New Attachment(strAttachmentPath))End If'Send emailTry\tsmtpClient.Send(oMail)Catch ex As Exception\tReturn getErrorMessage(ErrorMessage.ErrorSendingEmail)Finally\toMail = NothingEnd TryReturn TrueEnd Function</pre></div><h2>PHP</h2><p>And now for all things open-source, a PHP version.</p><p><i>Disclaimer: I haven't professionally worked with PHP since 2004, so if you have any suggestions to improve the code please add them to the comments.</i></p><h4>All-In-One (spaghetti-code)</h4><div class=\"html_block\"><pre>&lt;?phpif(isset($_POST['btnSubmit'])) { $mailto = \"nicholas@nicholasbarger.com\";$email = $_POST['tbEmail'];$subject = $_POST['tbSubject'];$message = $_POST['tbMessage'];$headers = 'From: $mailto'.\"\\r\\n\".'Reply-To: $mailto'.\"\\r\\n\";#Mail to Administratorif(mail($mailto, $subject, $message, $headers)){\t header('Location:contact_complete.php');}else{\t//Display an error}}?&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;PHP Contact Page Demo&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Contact Nicholas Barger&lt;/h1&gt;&lt;p&gt;Please feel free to contact me with questions, comments, or anything else that you would like to discuss. I appreciate your interest/involvement so I try and respond as quickly as possible.&lt;/p&gt;&lt;p&gt;You can also find me on &lt;i&gt;LinkedIn&lt;/i&gt; at: &lt;a href=\"http://www.linkedin.com/in/nicholasbarger\" target=\"_blank\"&gt;http://www.linkedin.com/in/nicholasbarger&lt;/a&gt;&lt;/p&gt;&lt;div class=\"formdisplay\"&gt;&lt;span&gt;Please enter your email address:&lt;/span&gt;&lt;br /&gt;&lt;input type=\"text\" id=\"tbEmail\" name=\"tbEmail\" style=\"width:700px;\"&gt;&lt;/input&gt;&lt;br /&gt;&lt;span&gt;Please enter a subject for this message:&lt;/span&gt;&lt;br /&gt;&lt;input type=\"text\" id=\"tbSubject\" name=\"tbSubject\" style=\"width:700px;\"&gt;&lt;/input&gt;&lt;br /&gt;&lt;span&gt;Please enter your message below:&lt;/span&gt;&lt;br /&gt;&lt;textarea id=\"tbMessage\" name=\"tbMessage\" style=\"width:700px; height:250px;\"&gt;&lt;/textarea&gt;&lt;br /&gt;&lt;/div&gt;&lt;input type=\"submit\" id=\"btnSubmit\" name=\"btnSubmit\" value=\"Send Message\" /&gt;&lt;/body&gt;&lt;/html&gt;</pre></div><h2>Make It Your Own</h2><p>What I've outlined here is just a beginning demonstration.  There is still work to be done, such as creating the contact complete page and notifying users that they successfully (or unsucessfully) contacted an administrator.  Additionally, you may want to add additional fields to be captured, add field validation to ensure proper data entry, or perhaps add a confirmation email response to the user as well.</p><p>Have fun with it, and take a boring contact page and make it something really powerful.  Hope this was helpful in getting you started, or refreshed on how to stay in touch with your visitors through a simple contact form!</p>"}