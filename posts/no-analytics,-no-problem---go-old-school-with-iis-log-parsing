{"id":"no-analytics,-no-problem---go-old-school-with-iis-log-parsing","title":"No Analytics, No Problem - Go Old School with IIS Log Parsing","description":"","link":"http://nicholasbarger.com/2009/01/16/no-analytics-no-problem-go-old-school-with-iis-log-parsing/","pubDate":"2009-01-16T19:22:25.000Z","content":"<p>Log Parser is a powerful little tool that allows you to write SQL-like queries against your IIS log files.  (I somewhat think this was a base for Powershell, but maybe that's just me).  You can <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=890cd06b-abf8-4c25-91b2-f8d975cf8c07&amp;displaylang=en\" target=\"_blank\">download Log Parser</a> from Microsoft.</p><p>Below are a few Log Parser scripts that I occasionally use on my own website(s) for double checking hit counts, page views, and top IIS errors occurring in the web application.</p><p>This is by far only a tiny sample of what you can do with Log Parser and those of you who are data mining fanatics, you can go nuts compiling information against your IIS log files!  Have fun!</p><p><i>Don't forget to change the path to point to your log file(s) directory for the website/web application you are analyzing.</i></p><p>Get hit count on web-resources:</p><div class=\"sql_block\">LOGPARSER \"SELECT COUNT(*) as [Count], cs-uri-stem, sc-status from 'c:\\mylogpath\\ex*.log' WHERE sc-status &lt;&gt; 200 GROUP BY cs-uri-stem, sc-status ORDER BY [Count] DESC\" -rtp:-1 -o:datagrid</div><p>Get page view count on webpages:</p><div class=\"sql_block\">LOGPARSER \"SELECT Date, COUNT (*) AS PAGEVIEWS FROM 'c:\\mylogpath\\ex*.log' WHERE EXTRACT_EXTENSION(to_lowercase(cs-uri-stem)) NOT IN ('asf';'axd';'css';'exe';'gif';'ico';'jpg';'js';'msi';'png';'txt';'vsi';'wmv';'xml';'zip') and sc-status=200 Group By Date\" -rtp:-1 -o:datagrid</div><p>Get unique visitors (by ip address):</p><div class=\"sql_block\">logparser \"SELECT DISTINCT date, c-ip INTO 'c:\\mylogpath\\Temporary.txt' FROM 'C:\\Program Files\\Log Parser 2.2\\web_logs\\ex*.log'\" -o:w3clogparser \"SELECT date, count(c-ip) FROM 'c:\\mylogpath\\Temporary.txt' GROUP BY date\" -i:w3c -o:datagrid </div><p>Get top IIS errors occurring on website/webapplication:</p><div class=\"sql_block\">LOGPARSER \"SELECT COUNT(*) as [Count], cs-uri-stem, sc-status from 'c:\\mylogpath\\ex*.log' WHERE sc-status &lt;&gt; 200 GROUP BY cs-uri-stem, sc-status ORDER BY [Count] DESC\" -rtp:-1 -o:datagrid</div><p>For security-related information on using Log Parser check out this <a href=\"http://www.securityfocus.com/infocus/1712\" target=\"_blank\">great article</a> from Security Focus.</p>"}